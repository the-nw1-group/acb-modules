<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Other Projects :: QUAD-IR</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>QUAD-IR</h1>
        <p>Based on the MERG "Hector", use reflected IR to detect trains</p>

        <p class="view"><a href="https://github.com/the-nw1-group/acb-modules/tree/master/misc/quad-ir">View stable on master branch <small>the-nw1-group/acb-modules/misc/quad-ir</small></a></p>
        <p class="view"><a href="https://github.com/the-nw1-group/acb-modules/tree/develop/misc/quad-ir">View latest on develop branch <small>the-nw1-group/acb-modules/misc/quad-ir</small></a></p>

      </header>
      <section>
        <h1>
<a id="another-control-bus" class="anchor" href="#another-control-bus" aria-hidden="true"><span class="octicon octicon-link"></span></a>QUAD-IR</h1>

<p>Derived from the Hector design by Bryan Knight and Pete Brownlow, to whom due credit is acknowledged. This version uses a small ARM processor (the so called
32-bits for 32 cents processor), which allowed 4 inputs over the original 2 inputs. A consequence of this is that the circuit voltage is reduced from 5V to 3.3V,
requiring the use of low voltage op-amps. The circuit works by taking a reading of the IR level with the IR LED turned off, then takes a reading when turned on.
If it's above the sense threshold the output is pulled low for that detector. If it then goes below the sense threshold a small amount of debouncing is applied
before turning the output high.</p>

<p>There are a couple of other changes from the original design: The IR LED current is sourced from the input supply rather than the regulated 3.3V; only occupied
outputs are available and these are 3.3V push-pull logic levels, with occupied indicated by a low output; supply voltage can be in the range 4.5V-12V.
Finally, then on board status led shows the detection without any debouncing, rather than a logical “or” of the outputs.</p>

<h2>
<a id="the-modules" class="anchor" href="#pin-functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pin Functions</h2>

<p>The pin functions are:</p>

<table>
<thead>
<tr>
<th>Pin</th>
<th>Function</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
    <tr>
        <td>1</td>
        <td>BOOT0</td>
        <td>I/P</td>
        <td>Tied to ground</td>
    </tr>
    <tr>
        <td>2</td>
        <td>PF0</td>
        <td>I/O</td>
        <td>(IN) Device Enable</td>
    </tr>
    <tr>
        <td>3</td>
        <td>PF1</td>
        <td>I/O</td>
        <td>(OUT) Detect 4 Output</td>
    </tr>
    <tr>
        <td>4</td>
        <td>NRST</td>
        <td>RST</td>
        <td>SWD - RST</td>
    </tr>
    <tr>
        <td>5</td>
        <td>VDDA</td>
        <td>S</td>
        <td>3.3v power supply</td>
    </tr>
    <tr>
        <td>6</td>
        <td>PA0</td>
        <td>I/0</td>
        <td>(OUT) Detect 3 Output</td>
    </tr>
    <tr>
        <td>7</td>
        <td>PA1</td>
        <td>I/0</td>
        <td>Not Used</td>
    </tr>
    <tr>
        <td>8</td>
        <td>PA2</td>
        <td>I/0</td>
        <td>(Analog) Sense Threshold</td>
    </tr>
    <tr>
        <td>9</td>
        <td>PA3</td>
        <td>I/0</td>
        <td>(Analog) Sense from Head 4</td>
    </tr>
    <tr>
        <td>10</td>
        <td>PA4</td>
        <td>I/0</td>
        <td>(Analog) Sense from Head 3</td>
    </tr>
    <tr>
        <td>11</td>
        <td>PA5</td>
        <td>I/0</td>
        <td>(Analog) Sense from Head 2</td>
    </tr>
    <tr>
        <td>12</td>
        <td>PA6</td>
        <td>I/0</td>
        <td>(Analog) Sense from Head 1</td>
    </tr>
    <tr>
        <td>13</td>
        <td>PA7</td>
        <td>I/0</td>
        <td>(OUT) IR LED Enable</td>
    </tr>
    <tr>
        <td>14</td>
        <td>PB1</td>
        <td>I/0</td>
        <td>(OUT) LED Status</td>
    </tr>
    <tr>
        <td>15</td>
        <td>VSS</td>
        <td>S</td>
        <td>Ground</td>
    </tr>
    <tr>
        <td>16</td>
        <td>VDD</td>
        <td>S</td>
        <td>3.3v power supply</td>
    </tr>
    <tr>
        <td>17</td>
        <td>PA9</td>
        <td>I/0</td>
        <td>(OUT) Detect 2 Output</td>
    </tr>

    <tr>
        <td>18</td>
        <td>PA10</td>
        <td>I/0</td>
        <td>(OUT) Detect 1 Output</td>
    </tr>
    <tr>
        <td>19</td>
        <td>PA13</td>
        <td>I/0</td>
        <td>SWD - SWDIO</td>
    </tr>
    <tr>
        <td>20</td>
        <td>PA14</td>
        <td>I/0</td>
        <td>SWD - SWCLK</td>
    </tr>
</tbody>
</table>

<h2>
<a id="other-notable-ics" class="anchor" href="#notable-ics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other notable ICs</h2>

<p>Other notable IC's on the board</p>

<table>
<thead>
<tr>
<th>Device</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LMV324</td>
<td>Quad Low-Voltage Rail-to-Rail Output Operational Amplifier</td>
</tr>
</tbody>
</table>

    <h2>
        <a id="schematic" class="anchor" href="#schematic" aria-hidden="true"><span class="octicon octicon-link"></span></a>Schematic
    </h2>

    <a href="assets/misc/quad-ir/quad-ir.pdf"><img src="assets/misc/quad-ir/quad-ir-sch.png" alt="Quad IR Schematic"/></a>
    <p>Click on the image above for a PDF version.</p>

    <h2>
        <a id="the-modules" class="anchor" href="#board-layout" aria-hidden="true"><span class="octicon octicon-link"></span></a>Board Layout
    </h2>

    <img src="assets/misc/quad-ir/quad-ir-pcb-top.png" alt="Quad IR top layout" />
    <p>The top of the board.</p>

    <img src="assets/misc/quad-ir/quad-ir-pcb-bottom.png" alt="Quad IR bottom layout" />
    <p>The bottom of the board.</p>

    <!--<img src="assets/misc/signal-tester/signal-tester.jpg" alt="Populated board" />
    <p>Populated board, with prototype 4 signal head connected.</p>-->

      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/the-nw1-group">the-nw1-group</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
